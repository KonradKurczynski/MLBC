% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimation.R
\name{one_step}
\alias{one_step}
\alias{one_step.default}
\alias{one_step.formula}
\title{One-step estimator for unlabeled data (multi-dist)}
\usage{
one_step(
  Y,
  Xhat = NULL,
  homoskedastic = FALSE,
  distribution = c("normal", "t", "laplace", "gamma", "beta"),
  nu = 4,
  gshape = 2,
  gscale = 1,
  ba = 2,
  bb = 2,
  intercept = TRUE,
  gen_idx = 1,
  data = parent.frame(),
  ...
)

\method{one_step}{default}(
  Y,
  Xhat,
  homoskedastic = FALSE,
  distribution = c("normal", "t", "laplace", "gamma", "beta"),
  nu = 4,
  gshape = 2,
  gscale = 1,
  ba = 2,
  bb = 2,
  intercept = TRUE,
  gen_idx = 1,
  ...
)

\method{one_step}{formula}(
  Y,
  Xhat = NULL,
  homoskedastic = FALSE,
  distribution = c("normal", "t", "laplace", "gamma", "beta"),
  nu = 4,
  gshape = 2,
  gscale = 1,
  ba = 2,
  bb = 2,
  intercept = TRUE,
  gen_idx = 1,
  data = parent.frame(),
  ...
)
}
\arguments{
\item{Y}{numeric response vector, or a one-sided formula}

\item{Xhat}{numeric matrix of regressors (if \code{Y} is numeric)}

\item{homoskedastic}{logical; if \code{TRUE}, assume equal error variance}

\item{distribution}{character; one of \code{"normal"}, \code{"t"}, \code{"laplace"}, \code{"gamma"}, \code{"beta"}}

\item{nu}{numeric; degrees of freedom (for Student-t)}

\item{gshape}{numeric; shape (for Gamma)}

\item{gscale}{numeric; scale (for Gamma)}

\item{ba}{numeric; alpha (for Beta)}

\item{bb}{numeric; beta (for Beta)}

\item{intercept}{logical; if \code{TRUE}, prepend an intercept column to \code{Xhat}}

\item{gen_idx}{integer; index (1-based) of the ML-generated column in \code{Xhat} \strong{before} intercept}

\item{data}{data frame (if \code{Y} is a formula)}

\item{...}{unused}
}
\value{
An object of class \code{mlbc_fit} and \code{mlbc_onestep} with:
\itemize{
\item \code{coef}: named coefficient vector
\item \code{cov} : covariance matrix
}
}
\description{
Fits the one-step estimator by maximizing the unlabeled likelihood via TMB,
automatically differentiating the objective, gradient, and Hessian.
}
\details{
Can be called either as
\itemize{
\item \code{one_step(Y, Xhat, ...)} where \code{Y} is numeric and \code{Xhat} a matrix, or
\item \code{one_step(formula, data, ...)} using a one-sided formula like \code{y ~ x1 + x2}.
}
}
